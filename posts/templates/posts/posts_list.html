{% extends 'layout.html' %}
{% block title %}Feed{% endblock %}
{% block content %}
<section class="feed-container">
    <div class="feed-header">
        <h1>üì± Feed</h1>
        {% if user.is_authenticated %}
            <a href="{% url 'posts:create' %}" class="btn-create">
                <span class="plus-icon">+</span> Create Post
            </a>
        {% endif %}
    </div>
    
    {% if posts %}
        <div class="posts-feed">
            {% for post in posts %}
            <article class="feed-card">
                <div class="card-header">
                    <div class="author-info">
                        <div class="author-avatar-placeholder">
                            {{ post.author.username|first|upper }}
                        </div>
                        <div class="author-meta">
                            <a href="{% url 'register:profile' username=post.author.username %}" class="author-name">
                                {{ post.author.username }}
                            </a>
                            <span class="post-time">{{ post.date|timesince }} ago</span>
                        </div>
                    </div>
                    {% if user.is_authenticated and post.author == user %}
                        <div class="post-options">
                            <a href="{% url 'posts:edit' slug=post.slug %}" class="option-btn" title="Edit">‚úèÔ∏è</a>
                            <form method="post" action="{% url 'posts:delete' slug=post.slug %}">
                                {% csrf_token %}
                                <button type="submit" class="option-btn delete-btn" onclick="return confirm('Delete this post?');" title="Delete">üóëÔ∏è</button>
                            </form>
                        </div>
                    {% endif %}
                </div>
                
                <a href="{% url 'posts:page' slug=post.slug %}" class="card-content-link">
                    {% if post.banner %}
                        <div class="card-image">
                            <img src="{{ post.banner.url }}" alt="{{ post.title }}">
                        </div>
                    {% endif %}
                    
                    <div class="card-body">
                        <h2 class="post-title">{{ post.title }}</h2>
                        <p class="post-excerpt">{{ post.body|truncatewords:30 }}</p>
                    </div>
                </a>
                
                <div class="card-footer">
                    <div class="action-buttons">
                        <a href="{% url 'posts:page' slug=post.slug %}" class="action-btn">
                            <span class="action-icon">üìñ</span>
                            <span class="action-label">Read</span>
                        </a>
                    </div>
                </div>
            </article>
            {% endfor %}
        </div>
    {% else %}
        <div class="empty-state">
            <div class="empty-icon">üì≠</div>
            <h3>No posts yet</h3>
            <p>
                {% if user.is_authenticated %}
                    Be the first to share something! <a href="{% url 'posts:create' %}">Create a post</a>
                {% else %}
                    <a href="{% url 'register:login' %}">Login</a> to start sharing
                {% endif %}
            </p>
        </div>
    {% endif %}
</section>
{% endblock %}
